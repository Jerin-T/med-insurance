<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>a85591c06bdc4f76a91fa7a24824e6db</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="ba466af7" class="cell markdown">
<p>Medical Insurance Premium Prediction System</p>
</div>
<div id="3c4470f0" class="cell code" data-execution_count="148"
data-_cell_guid="b1076dfc-b9ad-4769-8c92-a6c4dae69d19"
data-_uuid="8f2839f25d086af736a60e9eeb907d3b93b6e0e5"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:19.279388Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:19.279040Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:22.394192Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:22.393276Z&quot;}"
data-papermill="{&quot;duration&quot;:3.153308,&quot;end_time&quot;:&quot;2024-01-15T15:52:22.396932&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:19.243624&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Libraries for computing</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
</div>
<div id="2deb9ba6" class="cell markdown"
data-papermill="{&quot;duration&quot;:7.2449e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:22.575058&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:22.502609&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p>Med Insurance Dataset is an overall collection of data for
understanding the factors influencing medical costs and health insurance
premiums. The dataset contains information about 10 key variables,
providing insights into the diverse factors that impact insurance
pricing. The variables include:</p>
<ul>
<li><strong>Age:</strong> The age of the insured individual.</li>
<li><strong>Gender:</strong> The gender of the insured individual.</li>
<li><strong>BMI (Body Mass Index):</strong> A measure of body fat based
on height and weight.</li>
<li><strong>Children:</strong> The number of children covered by the
insurance plan.</li>
<li><strong>Smoking Status:</strong> Indicates whether the individual is
a smoker.</li>
<li><strong>Region:</strong> The geographical region of the insured
individual.</li>
<li><strong>Medical History:</strong> Information about the individual's
old medical problems.</li>
<li><strong>Family Medical History:</strong> Information about the
family's medical record.</li>
<li><strong>Exercise Frequency:</strong> The frequency of the
individual's exercise routine.</li>
<li><strong>Occupation:</strong> The occupation of the insured
individual.</li>
<li><strong>Coverage Level:</strong> The type of insurance plan.</li>
<li><strong>Charges:</strong> The health insurance charges for the
individual.</li>
</ul>
<p><strong>Data Types:</strong></p>
<ul>
<li>The 'age' and 'children' columns are of integer type.</li>
<li>The 'bmi' and 'charges' columns are of float type.</li>
<li>'gender', 'smoker', 'region', 'medical_history',
'family_medical_history', 'exercise_frequency', 'occupation', and
'coverage_level' are categorical columns of object type.</li>
</ul>
<p><strong>Categorical Features:</strong></p>
<ul>
<li>Categorical features include 'gender', 'smoker', 'region',
'medical_history', 'family_medical_history', 'exercise_frequency',
'occupation', and 'coverage_level'. These may need encoding for model
training.</li>
</ul>
<p><strong>Target Variable:</strong></p>
<ul>
<li>The 'charges' column is the target variable as it is of float
type.</li>
</ul>
</div>
<div id="fc6e7659" class="cell code" data-execution_count="149"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:22.642022Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:22.641176Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:25.664278Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:25.663240Z&quot;}"
data-papermill="{&quot;duration&quot;:3.05866,&quot;end_time&quot;:&quot;2024-01-15T15:52:25.666326&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:22.607666&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;C:</span><span class="ch">\\</span><span class="st">Users</span><span class="ch">\\</span><span class="st">USER</span><span class="ch">\\</span><span class="st">Downloads</span><span class="ch">\\</span><span class="st">New Folder (3)</span><span class="ch">\\</span><span class="st">insurance_dataset.csv&#39;</span>) <span class="co">#Importing the dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df.head() <span class="co">#first 5 rows</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="149">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>bmi</th>
      <th>children</th>
      <th>smoker</th>
      <th>region</th>
      <th>medical_history</th>
      <th>family_medical_history</th>
      <th>exercise_frequency</th>
      <th>occupation</th>
      <th>coverage_level</th>
      <th>charges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>46</td>
      <td>male</td>
      <td>21.4500</td>
      <td>5</td>
      <td>yes</td>
      <td>southeast</td>
      <td>Diabetes</td>
      <td>NaN</td>
      <td>Never</td>
      <td>Blue collar</td>
      <td>Premium</td>
      <td>20460.3077</td>
    </tr>
    <tr>
      <th>1</th>
      <td>25</td>
      <td>female</td>
      <td>25.3800</td>
      <td>2</td>
      <td>yes</td>
      <td>northwest</td>
      <td>Diabetes</td>
      <td>High blood pressure</td>
      <td>Occasionally</td>
      <td>White collar</td>
      <td>Premium</td>
      <td>20390.8992</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>male</td>
      <td>44.8800</td>
      <td>2</td>
      <td>yes</td>
      <td>southwest</td>
      <td>NaN</td>
      <td>High blood pressure</td>
      <td>Occasionally</td>
      <td>Blue collar</td>
      <td>Premium</td>
      <td>20204.4763</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25</td>
      <td>male</td>
      <td>19.8900</td>
      <td>0</td>
      <td>no</td>
      <td>northwest</td>
      <td>NaN</td>
      <td>Diabetes</td>
      <td>Rarely</td>
      <td>White collar</td>
      <td>Standard</td>
      <td>11789.0298</td>
    </tr>
    <tr>
      <th>4</th>
      <td>49</td>
      <td>male</td>
      <td>38.2100</td>
      <td>3</td>
      <td>yes</td>
      <td>northwest</td>
      <td>Diabetes</td>
      <td>High blood pressure</td>
      <td>Rarely</td>
      <td>White collar</td>
      <td>Standard</td>
      <td>19268.3098</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="dfa47431" class="cell code" data-execution_count="52"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:25.734749Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:25.734215Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:26.432204Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:26.431132Z&quot;}"
data-papermill="{&quot;duration&quot;:0.734028,&quot;end_time&quot;:&quot;2024-01-15T15:52:26.434513&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:25.700485&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1000000 entries, 0 to 999999
Data columns (total 12 columns):
 #   Column                  Non-Null Count    Dtype  
---  ------                  --------------    -----  
 0   age                     1000000 non-null  int64  
 1   gender                  1000000 non-null  object 
 2   bmi                     1000000 non-null  float64
 3   children                1000000 non-null  int64  
 4   smoker                  1000000 non-null  object 
 5   region                  1000000 non-null  object 
 6   medical_history         749238 non-null   object 
 7   family_medical_history  749596 non-null   object 
 8   exercise_frequency      1000000 non-null  object 
 9   occupation              1000000 non-null  object 
 10  coverage_level          1000000 non-null  object 
 11  charges                 1000000 non-null  float64
dtypes: float64(2), int64(2), object(8)
memory usage: 91.6+ MB
</code></pre>
</div>
</div>
<div id="4b782aec" class="cell markdown"
data-papermill="{&quot;duration&quot;:3.5299e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:26.503408&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:26.468109&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<p><strong>Handling Missing Values</strong></p>
</div>
<div id="64434c98" class="cell code" data-execution_count="53">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>() <span class="co"># checks for missing values</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="53">
<pre><code>age                            0
gender                         0
bmi                            0
children                       0
smoker                         0
region                         0
medical_history           250762
family_medical_history    250404
exercise_frequency             0
occupation                     0
coverage_level                 0
charges                        0
dtype: int64</code></pre>
</div>
</div>
<div id="f401c99b" class="cell code" data-execution_count="150"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:26.705441Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:26.704830Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:26.915147Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:26.914184Z&quot;}"
data-papermill="{&quot;duration&quot;:0.246452,&quot;end_time&quot;:&quot;2024-01-15T15:52:26.917570&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:26.671118&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fill null values</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> df.columns:</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  dtype <span class="op">=</span> df[column].dtypes</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>((dtype <span class="op">==</span> <span class="st">&#39;int64&#39;</span>) <span class="op">|</span> (dtype <span class="op">==</span><span class="st">&#39;float64&#39;</span>)):</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        mean_value <span class="op">=</span> df[column].mean()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        df[column].fillna(value<span class="op">=</span>mean_value, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      mode_value <span class="op">=</span> df[column].mode()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      df[column].fillna(value<span class="op">=</span>mode_value[<span class="dv">0</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div id="0496b17a" class="cell code" data-execution_count="55">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="55">
<pre><code>age                       0
gender                    0
bmi                       0
children                  0
smoker                    0
region                    0
medical_history           0
family_medical_history    0
exercise_frequency        0
occupation                0
coverage_level            0
charges                   0
dtype: int64</code></pre>
</div>
</div>
<div id="395a028e" class="cell code" data-execution_count="151"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:27.061088Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:27.060827Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:27.200290Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:27.199369Z&quot;}"
data-papermill="{&quot;duration&quot;:0.175497,&quot;end_time&quot;:&quot;2024-01-15T15:52:27.202258&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:27.026761&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="151">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>bmi</th>
      <th>children</th>
      <th>charges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000000.0000</td>
      <td>1000000.0000</td>
      <td>1000000.0000</td>
      <td>1000000.0000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>41.4953</td>
      <td>34.0018</td>
      <td>2.4999</td>
      <td>16735.1175</td>
    </tr>
    <tr>
      <th>std</th>
      <td>13.8552</td>
      <td>9.2317</td>
      <td>1.7077</td>
      <td>4415.8082</td>
    </tr>
    <tr>
      <th>min</th>
      <td>18.0000</td>
      <td>18.0000</td>
      <td>0.0000</td>
      <td>3445.0116</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>29.0000</td>
      <td>26.0200</td>
      <td>1.0000</td>
      <td>13600.3724</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>41.0000</td>
      <td>34.0000</td>
      <td>2.0000</td>
      <td>16622.1280</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>53.0000</td>
      <td>41.9900</td>
      <td>4.0000</td>
      <td>19781.4654</td>
    </tr>
    <tr>
      <th>max</th>
      <td>65.0000</td>
      <td>50.0000</td>
      <td>5.0000</td>
      <td>32561.5604</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="320f7652" class="cell code" data-execution_count="63">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Detecting outliers with boxplot on age and bmi</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(df[[<span class="st">&#39;age&#39;</span>,<span class="st">&#39;bmi&#39;</span>]])</span></code></pre></div>
<div class="output execute_result" data-execution_count="63">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/ccb7d6976a1072be4e4b3ba402fc0ab59eb95990.png" /></p>
</div>
</div>
<div id="15116e84" class="cell code" data-execution_count="64">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#No outliers were found</span></span></code></pre></div>
</div>
<div id="004f56dc" class="cell code" data-execution_count="160"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:27.344663Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:27.344358Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:27.377265Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:27.376571Z&quot;}"
data-papermill="{&quot;duration&quot;:7.0068e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:27.379342&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:27.309274&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> df.sample(n<span class="op">=</span><span class="dv">3000</span>,random_state<span class="op">=</span><span class="dv">101</span>) <span class="co">#A random sample of 3000 rows are taken for processing </span></span></code></pre></div>
</div>
<div id="4cec8523" class="cell code" data-execution_count="161">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Encoding on Categorical Features with One Hot Encoding</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> pd.get_dummies(new_df)</span></code></pre></div>
</div>
<div id="4a6c36f6" class="cell code" data-execution_count="154"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:27.594889Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:27.594618Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:27.600403Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:27.599367Z&quot;}"
data-papermill="{&quot;duration&quot;:4.1656e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:27.602388&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:27.560732&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>new_df.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="154">
<pre><code>Index([&#39;age&#39;, &#39;bmi&#39;, &#39;children&#39;, &#39;charges&#39;, &#39;gender_female&#39;, &#39;gender_male&#39;,
       &#39;smoker_no&#39;, &#39;smoker_yes&#39;, &#39;region_northeast&#39;, &#39;region_northwest&#39;,
       &#39;region_southeast&#39;, &#39;region_southwest&#39;, &#39;medical_history_Diabetes&#39;,
       &#39;medical_history_Heart disease&#39;, &#39;medical_history_High blood pressure&#39;,
       &#39;family_medical_history_Diabetes&#39;,
       &#39;family_medical_history_Heart disease&#39;,
       &#39;family_medical_history_High blood pressure&#39;,
       &#39;exercise_frequency_Frequently&#39;, &#39;exercise_frequency_Never&#39;,
       &#39;exercise_frequency_Occasionally&#39;, &#39;exercise_frequency_Rarely&#39;,
       &#39;occupation_Blue collar&#39;, &#39;occupation_Student&#39;, &#39;occupation_Unemployed&#39;,
       &#39;occupation_White collar&#39;, &#39;coverage_level_Basic&#39;,
       &#39;coverage_level_Premium&#39;, &#39;coverage_level_Standard&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div id="30f1e6e0" class="cell code" data-execution_count="155">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>new_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="155">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>bmi</th>
      <th>children</th>
      <th>charges</th>
      <th>gender_female</th>
      <th>gender_male</th>
      <th>smoker_no</th>
      <th>smoker_yes</th>
      <th>region_northeast</th>
      <th>region_northwest</th>
      <th>...</th>
      <th>exercise_frequency_Never</th>
      <th>exercise_frequency_Occasionally</th>
      <th>exercise_frequency_Rarely</th>
      <th>occupation_Blue collar</th>
      <th>occupation_Student</th>
      <th>occupation_Unemployed</th>
      <th>occupation_White collar</th>
      <th>coverage_level_Basic</th>
      <th>coverage_level_Premium</th>
      <th>coverage_level_Standard</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>180580</th>
      <td>23</td>
      <td>24.8000</td>
      <td>5</td>
      <td>22055.7561</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>209773</th>
      <td>41</td>
      <td>49.4900</td>
      <td>1</td>
      <td>16421.5201</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>820631</th>
      <td>36</td>
      <td>44.0000</td>
      <td>1</td>
      <td>22794.5031</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>...</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>886397</th>
      <td>25</td>
      <td>35.9500</td>
      <td>4</td>
      <td>13825.7908</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>672192</th>
      <td>61</td>
      <td>41.7600</td>
      <td>0</td>
      <td>18391.4845</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div>
</div>
</div>
<div id="cbdb1403" class="cell code" data-execution_count="65"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:30.611166Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:30.610567Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:30.630022Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:30.629140Z&quot;}"
data-papermill="{&quot;duration&quot;:5.8425e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:30.632187&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:30.573762&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="65">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>bmi</th>
      <th>children</th>
      <th>charges</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000000.0000</td>
      <td>1000000.0000</td>
      <td>1000000.0000</td>
      <td>1000000.0000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>41.4953</td>
      <td>34.0018</td>
      <td>2.4999</td>
      <td>16735.1175</td>
    </tr>
    <tr>
      <th>std</th>
      <td>13.8552</td>
      <td>9.2317</td>
      <td>1.7077</td>
      <td>4415.8082</td>
    </tr>
    <tr>
      <th>min</th>
      <td>18.0000</td>
      <td>18.0000</td>
      <td>0.0000</td>
      <td>3445.0116</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>29.0000</td>
      <td>26.0200</td>
      <td>1.0000</td>
      <td>13600.3724</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>41.0000</td>
      <td>34.0000</td>
      <td>2.0000</td>
      <td>16622.1280</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>53.0000</td>
      <td>41.9900</td>
      <td>4.0000</td>
      <td>19781.4654</td>
    </tr>
    <tr>
      <th>max</th>
      <td>65.0000</td>
      <td>50.0000</td>
      <td>5.0000</td>
      <td>32561.5604</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="51c7fba1" class="cell code" data-execution_count="69"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:30.849770Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:30.849415Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:30.859461Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:30.858595Z&quot;}"
data-papermill="{&quot;duration&quot;:4.8614e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:30.861384&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:30.812770&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df.age.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="69">
<pre><code>count   1000000.0000
mean         41.4953
std          13.8552
min          18.0000
25%          29.0000
50%          41.0000
75%          53.0000
max          65.0000
Name: age, dtype: float64</code></pre>
</div>
</div>
<div id="a7f0803c" class="cell code" data-execution_count="129"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:31.005045Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:31.004186Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:31.418005Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:31.417053Z&quot;}"
data-papermill="{&quot;duration&quot;:0.452618,&quot;end_time&quot;:&quot;2024-01-15T15:52:31.420036&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:30.967418&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Min age is 18 and the maximum age is 65</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.hist(df[<span class="st">&#39;age&#39;</span>],bins<span class="op">=</span><span class="dv">48</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/7af140f39b64e14557b9cd91560d23bfea73107c.png" /></p>
</div>
</div>
<div id="6e9a5e1b" class="cell code" data-execution_count="130"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:31.720513Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:31.720211Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:31.730557Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:31.729714Z&quot;}"
data-papermill="{&quot;duration&quot;:4.9607e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:31.732403&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:31.682796&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df.children.value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="130">
<pre><code>children
3    166925
2    166763
5    166733
0    166652
1    166596
4    166331
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="27259db9" class="cell code" data-execution_count="131"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:31.805425Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:31.805085Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:32.284165Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:32.283268Z&quot;}"
data-papermill="{&quot;duration&quot;:0.517822,&quot;end_time&quot;:&quot;2024-01-15T15:52:32.286400&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:31.768578&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sns.histplot(df,x<span class="op">=</span><span class="st">&#39;children&#39;</span>,bins<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distibution of Number of children&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="131">
<pre><code>Text(0.5, 1.0, &#39;Distibution of Number of children&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/56970fc9c09c5f4fd3a49ce36569e1d460e1747e.png" /></p>
</div>
</div>
<div id="bf8d848b" class="cell code" data-execution_count="78">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="78">
<pre><code>age                       0
gender                    0
bmi                       0
children                  0
smoker                    0
region                    0
medical_history           0
family_medical_history    0
exercise_frequency        0
occupation                0
coverage_level            0
charges                   0
dtype: int64</code></pre>
</div>
</div>
<div id="49868618" class="cell code" data-execution_count="132"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:32.578049Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:32.577746Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:33.043624Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:33.042747Z&quot;}"
data-papermill="{&quot;duration&quot;:0.505587,&quot;end_time&quot;:&quot;2024-01-15T15:52:33.046207&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:32.540620&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sns.histplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">&#39;charges&#39;</span>,bins<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">&#39;charges&#39;</span>].mean())</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/0153e191ff513ef6600e8b0a2eda1034a957c927.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>16735.117480593424
</code></pre>
</div>
</div>
<div id="beca4954" class="cell code" data-execution_count="81">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">&#39;charges&#39;</span>].describe())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>count   1000000.0000
mean      16735.1175
std        4415.8082
min        3445.0116
25%       13600.3724
50%       16622.1280
75%       19781.4654
max       32561.5604
Name: charges, dtype: float64
</code></pre>
</div>
</div>
<div id="5b931416" class="cell code" data-execution_count="133"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:33.196788Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:33.196476Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:33.767247Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:33.766372Z&quot;}"
data-papermill="{&quot;duration&quot;:0.611815,&quot;end_time&quot;:&quot;2024-01-15T15:52:33.769419&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:33.157604&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Smoker vs Charges</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(x <span class="op">=</span> <span class="st">&#39;charges&#39;</span>, hue <span class="op">=</span> <span class="st">&#39;smoker&#39;</span>, data <span class="op">=</span> df, multiple <span class="op">=</span> <span class="st">&#39;stack&#39;</span>, palette <span class="op">=</span> <span class="st">&#39;viridis&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="133">
<pre><code>&lt;Axes: xlabel=&#39;charges&#39;, ylabel=&#39;Count&#39;&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/e82a445cbae4f1a3aaa47c2e7a33f2f86dd5e4da.png" /></p>
</div>
</div>
<div id="42e4c7b6" class="cell code" data-execution_count="86">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;age&#39;</span>].plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, bins<span class="op">=</span><span class="dv">20</span>, title<span class="op">=</span><span class="st">&#39;age&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/56daec645389ad69ff756b5630cb257b5d9e13ba.png" /></p>
</div>
</div>
<div id="ca7d52ca" class="cell code" data-execution_count="134"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:33.923181Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:33.922838Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:34.546459Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:34.545584Z&quot;}"
data-papermill="{&quot;duration&quot;:0.667851,&quot;end_time&quot;:&quot;2024-01-15T15:52:34.551789&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:33.883938&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">10</span>))</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>new_df,y<span class="op">=</span><span class="st">&#39;charges&#39;</span>,x<span class="op">=</span><span class="st">&#39;bmi&#39;</span>,s<span class="op">=</span><span class="dv">200</span>,palette<span class="op">=</span><span class="st">&#39;dark&#39;</span>,c<span class="op">=</span><span class="st">&#39;r&#39;</span>,alpha<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Charges vs BMI&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="134">
<pre><code>Text(0.5, 1.0, &#39;Charges vs. BMI&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/29ef009024d5f8a86b44adfbd57ad5e1179a4077.png" /></p>
</div>
</div>
<div id="52f70897" class="cell code" data-execution_count="135"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:34.721816Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:34.721417Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:35.348482Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:35.347566Z&quot;}"
data-papermill="{&quot;duration&quot;:0.672956,&quot;end_time&quot;:&quot;2024-01-15T15:52:35.351671&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:34.678715&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">10</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sns.scatterplot(data<span class="op">=</span>new_df,y<span class="op">=</span><span class="st">&#39;charges&#39;</span>,x<span class="op">=</span><span class="st">&#39;age&#39;</span>,s<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Charges vs. Age&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="135">
<pre><code>Text(0.5, 1.0, &#39;Charges vs. Age&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/962c3da6ef99b46b1b2d04d41d0455621cbbb4df.png" /></p>
</div>
</div>
<div id="c9e78b1a" class="cell code" data-execution_count="90"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:36.219165Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:36.218819Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:36.613347Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:36.612367Z&quot;}"
data-papermill="{&quot;duration&quot;:0.443934,&quot;end_time&quot;:&quot;2024-01-15T15:52:36.615339&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:36.171405&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> sns.barplot(df,y<span class="op">=</span><span class="st">&#39;charges&#39;</span>,x<span class="op">=</span><span class="st">&#39;gender&#39;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Charges vs Gender&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="90">
<pre><code>Text(0.5, 1.0, &#39;Charges vs Gender&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/6eca3412364adfde8f57b52665680a378f430a75.png" /></p>
</div>
</div>
<div id="ab06bad5" class="cell code" data-execution_count="94"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:41.760524Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:41.760149Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:41.768049Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:41.767170Z&quot;}"
data-papermill="{&quot;duration&quot;:7.1349e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:41.770017&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:41.698668&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df.smoker.value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="94">
<pre><code>smoker
yes    500129
no     499871
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="3c1e3aea" class="cell markdown"
data-papermill="{&quot;duration&quot;:6.0062e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:42.415979&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:42.355917&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<h3 id="test-train-data-splitting">Test Train Data Splitting</h3>
</div>
<div id="2dab7f44" class="cell code" data-execution_count="162"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:42.689082Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:42.688750Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:42.694470Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:42.693599Z&quot;}"
data-papermill="{&quot;duration&quot;:6.8074e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:42.696528&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:42.628454&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> new_df[<span class="st">&#39;charges&#39;</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> new_df.drop(<span class="st">&#39;charges&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="da8f9835" class="cell code" data-execution_count="157"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:42.818423Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:42.818074Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:42.829362Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:42.828593Z&quot;}"
data-papermill="{&quot;duration&quot;:7.3641e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:42.831327&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:42.757686&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> new_df.corr()</span></code></pre></div>
</div>
<div id="b7f13c87" class="cell code" data-execution_count="111"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:42.952214Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:42.951855Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:42.979173Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:42.978232Z&quot;}"
data-papermill="{&quot;duration&quot;:8.9473e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:42.980999&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:42.891526&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix</span></code></pre></div>
<div class="output execute_result" data-execution_count="111">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>bmi</th>
      <th>children</th>
      <th>charges</th>
      <th>gender_female</th>
      <th>gender_male</th>
      <th>smoker_no</th>
      <th>smoker_yes</th>
      <th>region_northeast</th>
      <th>region_northwest</th>
      <th>...</th>
      <th>exercise_frequency_Never</th>
      <th>exercise_frequency_Occasionally</th>
      <th>exercise_frequency_Rarely</th>
      <th>occupation_Blue collar</th>
      <th>occupation_Student</th>
      <th>occupation_Unemployed</th>
      <th>occupation_White collar</th>
      <th>coverage_level_Basic</th>
      <th>coverage_level_Premium</th>
      <th>coverage_level_Standard</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>age</th>
      <td>1.0000</td>
      <td>-0.0060</td>
      <td>-0.0208</td>
      <td>0.0426</td>
      <td>0.0005</td>
      <td>-0.0005</td>
      <td>-0.0037</td>
      <td>0.0037</td>
      <td>0.0085</td>
      <td>-0.0236</td>
      <td>...</td>
      <td>-0.0189</td>
      <td>0.0059</td>
      <td>0.0087</td>
      <td>0.0122</td>
      <td>0.0205</td>
      <td>0.0112</td>
      <td>-0.0435</td>
      <td>0.0150</td>
      <td>0.0005</td>
      <td>-0.0152</td>
    </tr>
    <tr>
      <th>bmi</th>
      <td>-0.0060</td>
      <td>1.0000</td>
      <td>0.0316</td>
      <td>0.0814</td>
      <td>-0.0048</td>
      <td>0.0048</td>
      <td>0.0207</td>
      <td>-0.0207</td>
      <td>0.0285</td>
      <td>-0.0296</td>
      <td>...</td>
      <td>0.0138</td>
      <td>-0.0085</td>
      <td>0.0089</td>
      <td>0.0339</td>
      <td>-0.0246</td>
      <td>-0.0169</td>
      <td>0.0069</td>
      <td>-0.0276</td>
      <td>0.0102</td>
      <td>0.0170</td>
    </tr>
    <tr>
      <th>children</th>
      <td>-0.0208</td>
      <td>0.0316</td>
      <td>1.0000</td>
      <td>0.0746</td>
      <td>0.0189</td>
      <td>-0.0189</td>
      <td>-0.0213</td>
      <td>0.0213</td>
      <td>-0.0063</td>
      <td>0.0160</td>
      <td>...</td>
      <td>0.0348</td>
      <td>-0.0333</td>
      <td>-0.0046</td>
      <td>0.0303</td>
      <td>-0.0524</td>
      <td>0.0565</td>
      <td>-0.0327</td>
      <td>-0.0003</td>
      <td>-0.0208</td>
      <td>0.0211</td>
    </tr>
    <tr>
      <th>charges</th>
      <td>0.0426</td>
      <td>0.0814</td>
      <td>0.0746</td>
      <td>1.0000</td>
      <td>-0.0645</td>
      <td>0.0645</td>
      <td>-0.5931</td>
      <td>0.5931</td>
      <td>0.0834</td>
      <td>-0.0017</td>
      <td>...</td>
      <td>-0.1618</td>
      <td>0.0244</td>
      <td>-0.0035</td>
      <td>0.0979</td>
      <td>-0.0652</td>
      <td>-0.1618</td>
      <td>0.1238</td>
      <td>-0.3709</td>
      <td>0.4218</td>
      <td>-0.0569</td>
    </tr>
    <tr>
      <th>gender_female</th>
      <td>0.0005</td>
      <td>-0.0048</td>
      <td>0.0189</td>
      <td>-0.0645</td>
      <td>1.0000</td>
      <td>-1.0000</td>
      <td>-0.0160</td>
      <td>0.0160</td>
      <td>0.0115</td>
      <td>0.0043</td>
      <td>...</td>
      <td>-0.0473</td>
      <td>0.0077</td>
      <td>0.0027</td>
      <td>-0.0002</td>
      <td>-0.0214</td>
      <td>0.0302</td>
      <td>-0.0076</td>
      <td>-0.0344</td>
      <td>0.0402</td>
      <td>-0.0063</td>
    </tr>
    <tr>
      <th>gender_male</th>
      <td>-0.0005</td>
      <td>0.0048</td>
      <td>-0.0189</td>
      <td>0.0645</td>
      <td>-1.0000</td>
      <td>1.0000</td>
      <td>0.0160</td>
      <td>-0.0160</td>
      <td>-0.0115</td>
      <td>-0.0043</td>
      <td>...</td>
      <td>0.0473</td>
      <td>-0.0077</td>
      <td>-0.0027</td>
      <td>0.0002</td>
      <td>0.0214</td>
      <td>-0.0302</td>
      <td>0.0076</td>
      <td>0.0344</td>
      <td>-0.0402</td>
      <td>0.0063</td>
    </tr>
    <tr>
      <th>smoker_no</th>
      <td>-0.0037</td>
      <td>0.0207</td>
      <td>-0.0213</td>
      <td>-0.5931</td>
      <td>-0.0160</td>
      <td>0.0160</td>
      <td>1.0000</td>
      <td>-1.0000</td>
      <td>-0.0014</td>
      <td>-0.0087</td>
      <td>...</td>
      <td>0.0350</td>
      <td>0.0024</td>
      <td>-0.0250</td>
      <td>-0.0115</td>
      <td>-0.0271</td>
      <td>0.0138</td>
      <td>0.0252</td>
      <td>0.0095</td>
      <td>-0.0085</td>
      <td>-0.0009</td>
    </tr>
    <tr>
      <th>smoker_yes</th>
      <td>0.0037</td>
      <td>-0.0207</td>
      <td>0.0213</td>
      <td>0.5931</td>
      <td>0.0160</td>
      <td>-0.0160</td>
      <td>-1.0000</td>
      <td>1.0000</td>
      <td>0.0014</td>
      <td>0.0087</td>
      <td>...</td>
      <td>-0.0350</td>
      <td>-0.0024</td>
      <td>0.0250</td>
      <td>0.0115</td>
      <td>0.0271</td>
      <td>-0.0138</td>
      <td>-0.0252</td>
      <td>-0.0095</td>
      <td>0.0085</td>
      <td>0.0009</td>
    </tr>
    <tr>
      <th>region_northeast</th>
      <td>0.0085</td>
      <td>0.0285</td>
      <td>-0.0063</td>
      <td>0.0834</td>
      <td>0.0115</td>
      <td>-0.0115</td>
      <td>-0.0014</td>
      <td>0.0014</td>
      <td>1.0000</td>
      <td>-0.3347</td>
      <td>...</td>
      <td>0.0215</td>
      <td>-0.0320</td>
      <td>-0.0108</td>
      <td>0.0213</td>
      <td>-0.0281</td>
      <td>-0.0195</td>
      <td>0.0256</td>
      <td>-0.0010</td>
      <td>-0.0208</td>
      <td>0.0218</td>
    </tr>
    <tr>
      <th>region_northwest</th>
      <td>-0.0236</td>
      <td>-0.0296</td>
      <td>0.0160</td>
      <td>-0.0017</td>
      <td>0.0043</td>
      <td>-0.0043</td>
      <td>-0.0087</td>
      <td>0.0087</td>
      <td>-0.3347</td>
      <td>1.0000</td>
      <td>...</td>
      <td>0.0098</td>
      <td>0.0018</td>
      <td>-0.0040</td>
      <td>0.0009</td>
      <td>0.0131</td>
      <td>-0.0219</td>
      <td>0.0072</td>
      <td>-0.0182</td>
      <td>0.0334</td>
      <td>-0.0155</td>
    </tr>
    <tr>
      <th>region_southeast</th>
      <td>-0.0012</td>
      <td>0.0214</td>
      <td>-0.0181</td>
      <td>-0.0126</td>
      <td>-0.0216</td>
      <td>0.0216</td>
      <td>-0.0173</td>
      <td>0.0173</td>
      <td>-0.3188</td>
      <td>-0.3250</td>
      <td>...</td>
      <td>0.0077</td>
      <td>0.0192</td>
      <td>-0.0149</td>
      <td>0.0237</td>
      <td>0.0079</td>
      <td>0.0076</td>
      <td>-0.0390</td>
      <td>0.0002</td>
      <td>-0.0008</td>
      <td>0.0006</td>
    </tr>
    <tr>
      <th>region_southwest</th>
      <td>0.0161</td>
      <td>-0.0193</td>
      <td>0.0078</td>
      <td>-0.0679</td>
      <td>0.0054</td>
      <td>-0.0054</td>
      <td>0.0268</td>
      <td>-0.0268</td>
      <td>-0.3414</td>
      <td>-0.3480</td>
      <td>...</td>
      <td>-0.0383</td>
      <td>0.0111</td>
      <td>0.0289</td>
      <td>-0.0447</td>
      <td>0.0070</td>
      <td>0.0334</td>
      <td>0.0054</td>
      <td>0.0188</td>
      <td>-0.0119</td>
      <td>-0.0066</td>
    </tr>
    <tr>
      <th>medical_history_Diabetes</th>
      <td>-0.0127</td>
      <td>-0.0340</td>
      <td>-0.0113</td>
      <td>-0.0109</td>
      <td>-0.0034</td>
      <td>0.0034</td>
      <td>-0.0069</td>
      <td>0.0069</td>
      <td>-0.0200</td>
      <td>0.0156</td>
      <td>...</td>
      <td>-0.0100</td>
      <td>0.0166</td>
      <td>0.0094</td>
      <td>-0.0009</td>
      <td>0.0007</td>
      <td>-0.0010</td>
      <td>0.0012</td>
      <td>0.0188</td>
      <td>-0.0109</td>
      <td>-0.0075</td>
    </tr>
    <tr>
      <th>medical_history_Heart disease</th>
      <td>-0.0079</td>
      <td>0.0172</td>
      <td>0.0066</td>
      <td>0.1329</td>
      <td>-0.0210</td>
      <td>0.0210</td>
      <td>-0.0160</td>
      <td>0.0160</td>
      <td>0.0171</td>
      <td>0.0171</td>
      <td>...</td>
      <td>-0.0063</td>
      <td>0.0002</td>
      <td>0.0136</td>
      <td>0.0144</td>
      <td>-0.0086</td>
      <td>-0.0058</td>
      <td>-0.0003</td>
      <td>-0.0224</td>
      <td>0.0452</td>
      <td>-0.0232</td>
    </tr>
    <tr>
      <th>medical_history_High blood pressure</th>
      <td>0.0215</td>
      <td>0.0137</td>
      <td>0.0035</td>
      <td>-0.1405</td>
      <td>0.0272</td>
      <td>-0.0272</td>
      <td>0.0250</td>
      <td>-0.0250</td>
      <td>0.0002</td>
      <td>-0.0347</td>
      <td>...</td>
      <td>0.0169</td>
      <td>-0.0165</td>
      <td>-0.0247</td>
      <td>-0.0155</td>
      <td>0.0091</td>
      <td>0.0076</td>
      <td>-0.0009</td>
      <td>0.0071</td>
      <td>-0.0407</td>
      <td>0.0337</td>
    </tr>
    <tr>
      <th>family_medical_history_Diabetes</th>
      <td>0.0277</td>
      <td>-0.0114</td>
      <td>-0.0154</td>
      <td>0.0303</td>
      <td>-0.0076</td>
      <td>0.0076</td>
      <td>-0.0170</td>
      <td>0.0170</td>
      <td>0.0277</td>
      <td>0.0009</td>
      <td>...</td>
      <td>-0.0280</td>
      <td>-0.0125</td>
      <td>0.0295</td>
      <td>0.0160</td>
      <td>-0.0222</td>
      <td>-0.0123</td>
      <td>0.0181</td>
      <td>-0.0363</td>
      <td>0.0364</td>
      <td>-0.0007</td>
    </tr>
    <tr>
      <th>family_medical_history_Heart disease</th>
      <td>-0.0256</td>
      <td>-0.0050</td>
      <td>0.0124</td>
      <td>0.0972</td>
      <td>-0.0075</td>
      <td>0.0075</td>
      <td>0.0137</td>
      <td>-0.0137</td>
      <td>-0.0270</td>
      <td>0.0085</td>
      <td>...</td>
      <td>0.0258</td>
      <td>0.0080</td>
      <td>-0.0255</td>
      <td>-0.0253</td>
      <td>0.0232</td>
      <td>0.0058</td>
      <td>-0.0034</td>
      <td>0.0185</td>
      <td>-0.0137</td>
      <td>-0.0045</td>
    </tr>
    <tr>
      <th>family_medical_history_High blood pressure</th>
      <td>0.0016</td>
      <td>0.0172</td>
      <td>0.0012</td>
      <td>-0.1422</td>
      <td>0.0162</td>
      <td>-0.0162</td>
      <td>0.0014</td>
      <td>-0.0014</td>
      <td>0.0032</td>
      <td>-0.0106</td>
      <td>...</td>
      <td>-0.0015</td>
      <td>0.0034</td>
      <td>-0.0003</td>
      <td>0.0130</td>
      <td>-0.0043</td>
      <td>0.0057</td>
      <td>-0.0143</td>
      <td>0.0152</td>
      <td>-0.0208</td>
      <td>0.0059</td>
    </tr>
    <tr>
      <th>exercise_frequency_Frequently</th>
      <td>0.0041</td>
      <td>-0.0142</td>
      <td>0.0032</td>
      <td>0.1398</td>
      <td>0.0365</td>
      <td>-0.0365</td>
      <td>-0.0116</td>
      <td>0.0116</td>
      <td>0.0214</td>
      <td>-0.0074</td>
      <td>...</td>
      <td>-0.3262</td>
      <td>-0.3259</td>
      <td>-0.3465</td>
      <td>0.0122</td>
      <td>0.0011</td>
      <td>0.0087</td>
      <td>-0.0217</td>
      <td>-0.0359</td>
      <td>-0.0026</td>
      <td>0.0379</td>
    </tr>
    <tr>
      <th>exercise_frequency_Never</th>
      <td>-0.0189</td>
      <td>0.0138</td>
      <td>0.0348</td>
      <td>-0.1618</td>
      <td>-0.0473</td>
      <td>0.0473</td>
      <td>0.0350</td>
      <td>-0.0350</td>
      <td>0.0215</td>
      <td>0.0098</td>
      <td>...</td>
      <td>1.0000</td>
      <td>-0.3203</td>
      <td>-0.3405</td>
      <td>-0.0429</td>
      <td>-0.0095</td>
      <td>0.0258</td>
      <td>0.0275</td>
      <td>0.0520</td>
      <td>-0.0312</td>
      <td>-0.0200</td>
    </tr>
    <tr>
      <th>exercise_frequency_Occasionally</th>
      <td>0.0059</td>
      <td>-0.0085</td>
      <td>-0.0333</td>
      <td>0.0244</td>
      <td>0.0077</td>
      <td>-0.0077</td>
      <td>0.0024</td>
      <td>-0.0024</td>
      <td>-0.0320</td>
      <td>0.0018</td>
      <td>...</td>
      <td>-0.3203</td>
      <td>1.0000</td>
      <td>-0.3402</td>
      <td>0.0216</td>
      <td>-0.0025</td>
      <td>-0.0134</td>
      <td>-0.0062</td>
      <td>-0.0134</td>
      <td>0.0187</td>
      <td>-0.0055</td>
    </tr>
    <tr>
      <th>exercise_frequency_Rarely</th>
      <td>0.0087</td>
      <td>0.0089</td>
      <td>-0.0046</td>
      <td>-0.0035</td>
      <td>0.0027</td>
      <td>-0.0027</td>
      <td>-0.0250</td>
      <td>0.0250</td>
      <td>-0.0108</td>
      <td>-0.0040</td>
      <td>...</td>
      <td>-0.3405</td>
      <td>-0.3402</td>
      <td>1.0000</td>
      <td>0.0087</td>
      <td>0.0106</td>
      <td>-0.0205</td>
      <td>0.0006</td>
      <td>-0.0024</td>
      <td>0.0147</td>
      <td>-0.0124</td>
    </tr>
    <tr>
      <th>occupation_Blue collar</th>
      <td>0.0122</td>
      <td>0.0339</td>
      <td>0.0303</td>
      <td>0.0979</td>
      <td>-0.0002</td>
      <td>0.0002</td>
      <td>-0.0115</td>
      <td>0.0115</td>
      <td>0.0213</td>
      <td>0.0009</td>
      <td>...</td>
      <td>-0.0429</td>
      <td>0.0216</td>
      <td>0.0087</td>
      <td>1.0000</td>
      <td>-0.3437</td>
      <td>-0.3241</td>
      <td>-0.3448</td>
      <td>-0.0147</td>
      <td>0.0075</td>
      <td>0.0070</td>
    </tr>
    <tr>
      <th>occupation_Student</th>
      <td>0.0205</td>
      <td>-0.0246</td>
      <td>-0.0524</td>
      <td>-0.0652</td>
      <td>-0.0214</td>
      <td>0.0214</td>
      <td>-0.0271</td>
      <td>0.0271</td>
      <td>-0.0281</td>
      <td>0.0131</td>
      <td>...</td>
      <td>-0.0095</td>
      <td>-0.0025</td>
      <td>0.0106</td>
      <td>-0.3437</td>
      <td>1.0000</td>
      <td>-0.3218</td>
      <td>-0.3423</td>
      <td>0.0152</td>
      <td>-0.0015</td>
      <td>-0.0135</td>
    </tr>
    <tr>
      <th>occupation_Unemployed</th>
      <td>0.0112</td>
      <td>-0.0169</td>
      <td>0.0565</td>
      <td>-0.1618</td>
      <td>0.0302</td>
      <td>-0.0302</td>
      <td>0.0138</td>
      <td>-0.0138</td>
      <td>-0.0195</td>
      <td>-0.0219</td>
      <td>...</td>
      <td>0.0258</td>
      <td>-0.0134</td>
      <td>-0.0205</td>
      <td>-0.3241</td>
      <td>-0.3218</td>
      <td>1.0000</td>
      <td>-0.3228</td>
      <td>0.0304</td>
      <td>-0.0346</td>
      <td>0.0047</td>
    </tr>
    <tr>
      <th>occupation_White collar</th>
      <td>-0.0435</td>
      <td>0.0069</td>
      <td>-0.0327</td>
      <td>0.1238</td>
      <td>-0.0076</td>
      <td>0.0076</td>
      <td>0.0252</td>
      <td>-0.0252</td>
      <td>0.0256</td>
      <td>0.0072</td>
      <td>...</td>
      <td>0.0275</td>
      <td>-0.0062</td>
      <td>0.0006</td>
      <td>-0.3448</td>
      <td>-0.3423</td>
      <td>-0.3228</td>
      <td>1.0000</td>
      <td>-0.0299</td>
      <td>0.0275</td>
      <td>0.0019</td>
    </tr>
    <tr>
      <th>coverage_level_Basic</th>
      <td>0.0150</td>
      <td>-0.0276</td>
      <td>-0.0003</td>
      <td>-0.3709</td>
      <td>-0.0344</td>
      <td>0.0344</td>
      <td>0.0095</td>
      <td>-0.0095</td>
      <td>-0.0010</td>
      <td>-0.0182</td>
      <td>...</td>
      <td>0.0520</td>
      <td>-0.0134</td>
      <td>-0.0024</td>
      <td>-0.0147</td>
      <td>0.0152</td>
      <td>0.0304</td>
      <td>-0.0299</td>
      <td>1.0000</td>
      <td>-0.4928</td>
      <td>-0.4915</td>
    </tr>
    <tr>
      <th>coverage_level_Premium</th>
      <td>0.0005</td>
      <td>0.0102</td>
      <td>-0.0208</td>
      <td>0.4218</td>
      <td>0.0402</td>
      <td>-0.0402</td>
      <td>-0.0085</td>
      <td>0.0085</td>
      <td>-0.0208</td>
      <td>0.0334</td>
      <td>...</td>
      <td>-0.0312</td>
      <td>0.0187</td>
      <td>0.0147</td>
      <td>0.0075</td>
      <td>-0.0015</td>
      <td>-0.0346</td>
      <td>0.0275</td>
      <td>-0.4928</td>
      <td>1.0000</td>
      <td>-0.5156</td>
    </tr>
    <tr>
      <th>coverage_level_Standard</th>
      <td>-0.0152</td>
      <td>0.0170</td>
      <td>0.0211</td>
      <td>-0.0569</td>
      <td>-0.0063</td>
      <td>0.0063</td>
      <td>-0.0009</td>
      <td>0.0009</td>
      <td>0.0218</td>
      <td>-0.0155</td>
      <td>...</td>
      <td>-0.0200</td>
      <td>-0.0055</td>
      <td>-0.0124</td>
      <td>0.0070</td>
      <td>-0.0135</td>
      <td>0.0047</td>
      <td>0.0019</td>
      <td>-0.4915</td>
      <td>-0.5156</td>
      <td>1.0000</td>
    </tr>
  </tbody>
</table>
<p>29 rows × 29 columns</p>
</div>
</div>
</div>
<div id="cd16daee" class="cell code" data-execution_count="112"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:43.112749Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:43.112377Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:45.928326Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:45.927355Z&quot;}"
data-papermill="{&quot;duration&quot;:2.895278,&quot;end_time&quot;:&quot;2024-01-15T15:52:45.935888&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:43.040610&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">30</span>,<span class="dv">30</span>))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix,vmax<span class="op">=</span><span class="dv">1</span>,vmin<span class="op">=-</span><span class="dv">1</span>,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="112">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_6d9ea7e004c54199b1b4aa0121a0d7a5/86efeaec0fdbe5f5733ab7d1ac3a027f27256edd.png" /></p>
</div>
</div>
<div id="8ad781e0" class="cell code" data-execution_count="163"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-01-15T15:52:49.882377Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-01-15T15:52:49.881992Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-01-15T15:52:49.889053Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-01-15T15:52:49.888323Z&quot;}"
data-papermill="{&quot;duration&quot;:8.1138e-2,&quot;end_time&quot;:&quot;2024-01-15T15:52:49.890973&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2024-01-15T15:52:49.809835&quot;,&quot;status&quot;:&quot;completed&quot;}"
data-tags="[]">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>X_train,X_test,Y_train,Y_test <span class="op">=</span> train_test_split(x,y,test_size<span class="op">=</span><span class="fl">0.2</span>,random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
</div>
<div id="ff013dde" class="cell code" data-execution_count="165">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standardising the data</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>sc<span class="op">=</span>StandardScaler()</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>X_train<span class="op">=</span>sc.fit_transform(X_train)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>X_test<span class="op">=</span>sc.transform(X_test)</span></code></pre></div>
</div>
<div id="b539395f" class="cell code" data-execution_count="166">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>lr <span class="op">=</span> LinearRegression()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>lr.fit(X_train,Y_train)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>Train_Y_Predicted <span class="op">=</span> lr.predict(X_train)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>Test_Y_Predicted <span class="op">=</span> lr.predict(X_test)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Training Accuracy&#39;</span>,r2_score(Y_train,Train_Y_Predicted))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Testing Accuracy&#39;</span>,r2_score(Y_test,Test_Y_Predicted))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training Accuracy 0.6925227711548241
Testing Accuracy 0.6788916063152444
</code></pre>
</div>
</div>
<div id="c088bcf9" class="cell code">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking has the most impact on Medical Insurance premiums</span></span></code></pre></div>
</div>
</body>
</html>
